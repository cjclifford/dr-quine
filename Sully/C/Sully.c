const unsigned char source[] = {
	'\n',
	'#','i','n','c','l','u','d','e',' ','<','s','t','d','i','o','.','h','>','\n',
	'#','i','n','c','l','u','d','e',' ','<','s','t','d','l','i','b','.','h','>','\n',
	'\n',
	'i','n','t',' ','m','a','i','n','(','v','o','i','d',')',' ','{','\n',
	'\t','u','n','s','i','g','n','e','d',' ','i','n','t',' ','l','i','m','i','t',' ','=',' ','5',';','\n',
	'\t','l','i','m','i','t','-','-',';','\n',
	'\t','c','h','a','r',' ','b','i','n','a','r','y','N','a','m','e','[','8',']',';','\n',
	'\t','c','h','a','r',' ','f','i','l','e','N','a','m','e','[','1','0',']',';','\n',
	'\t','s','n','p','r','i','n','t','f','(','b','i','n','a','r','y','N','a','m','e',',',' ','s','i','z','e','o','f','(','b','i','n','a','r','y','N','a','m','e',')',',',' ','\"','S','u','l','l','y','_','%','u','\"',',',' ','l','i','m','i','t',')',';','\n',
	'\t','s','n','p','r','i','n','t','f','(','f','i','l','e','N','a','m','e',',',' ','s','i','z','e','o','f','(','f','i','l','e','N','a','m','e',')',',',' ','\"','%','s','.','c','\"',',',' ','b','i','n','a','r','y','N','a','m','e',')',';','\n',
	'\t','F','I','L','E',' ','*','p','F','i','l','e',' ','=',' ','f','o','p','e','n','(','f','i','l','e','N','a','m','e',',',' ','\"','w','\"',')',';','\n',
	'\t','u','n','s','i','g','n','e','d',' ','i','n','t',' ','i',';','\n',
	'\t','f','p','r','i','n','t','f','(','p','F','i','l','e',',',' ','\"','c','o','n','s','t',' ','u','n','s','i','g','n','e','d',' ','c','h','a','r',' ','s','o','u','r','c','e','[',']',' ','=',' ','{','\\','n','\"',')',';','\n',
	'\t','f','o','r',' ','(','i',' ', '=',' ','0',';',' ','i',' ','<',' ','s','i','z','e','o','f','(','s','o','u','r','c','e',')',';',' ','i','+','+',')',' ','{','\n',
	'\t','\t','i','f',' ','(','i',' ','=','=',' ','8','0',')','\n',
	'\t','\t','\t','f','p','r','i','n','t','f','(','p','F','i','l','e',',',' ','\"','%','0','#','4','x',',','\"',',',' ','l','i','m','i','t',')',';','\n',
	'\t','\t','e','l','s','e','\n',
	'\t','\t','\t','f','p','r','i','n','t','f','(','p','F','i','l','e',',',' ','\"','%','0','#','4','x',',','\"',',',' ','s','o','u','r','c','e','[','i',']',')',';','\n',
	'\t','}','\n',
	'\t','f', 'p','r','i','n','t','f','(','p','F','i','l','e',',',' ','\"','\\','n','}',';','\\','n','\"',')',';','\n',
	'\t','f','o','r',' ','(','i',' ','=',' ','0',';',' ','i',' ','<',' ','s','i','z','e','o','f','(','s','o','u','r','c','e',')',';',' ','i','+','+',')',' ','{','\n',
	'\t','\t','i','f',' ','(','i',' ','=','=',' ','8','0',')','\n',
	'\t','\t','\t','f','p','r','i','n','t','f','(','p','F','i','l','e',',',' ','\"','%','d','\"',',',' ','l','i','m','i','t',')',';','\n',
	'\t','\t','e','l','s','e','\n',
	'\t','\t','\t','f','p','r','i','n','t','f','(','p','F','i','l','e',',',' ','\"','%','c','\"',',',' ','s','o','u','r','c','e','[','i',']',')',';','\n',
	'\t','}','\n',
	'\t','c','h','a','r',' ','s','y','s','[','3','8',']',';','\n',
	'\t','f','c','l','o','s','e','(','p','F','i','l','e',')',';','\n',
	'\t','i','f',' ','(','l','i','m','i','t',' ','>',' ','0',')',' ','{','\n',
	'\t','\t','s','n','p','r','i','n','t','f','(','s','y','s',',',' ','s','i','z','e','o','f','(','s','y','s',')',',',' ','\"','c','l','a','n','g',' ','%','s',' ','-','o',' ','%','s',';',' ','.','/','%','s','\"',',',' ','f','i','l','e','N','a','m','e',',',' ','b','i','n','a','r','y','N','a','m','e',',',' ','f','i','l','e','N','a','m','e',')',';','\n',
	'\t','\t','s','y','s','t','e','m','(','s','y','s',')',';','\n',
	'\t','}','\n',
	'\t','r','e','t','u','r','n',' ','0',';','\n',
	'}'
};

#include <stdio.h>
#include <stdlib.h>

int main(void) {
	unsigned int limit = 5;
	limit--;
	char binaryName[8];
	char fileName[10];
	snprintf(binaryName, sizeof(binaryName), "Sully_%u", limit);
	snprintf(fileName, sizeof(fileName), "%s.c", binaryName);
	FILE *pFile = fopen(fileName, "w");
	unsigned int i;
	fprintf(pFile, "const unsigned char source[] = {\n\t");
	for (i = 0; i < sizeof(source); i++) {
		if (i == 80)
			fprintf(pFile, "%0#4x,", limit);
		else
			fprintf(pFile, "%0#4x,", source[i]);
	}
	fprintf(pFile, "\n};\n");
	for (i = 0; i < sizeof(source); i++) {
		if (i == 80)
			fprintf(pFile, "%d", limit);
		else
			fprintf(pFile, "%c", source[i]);
	}
	char sys[38];
	fclose(pFile);
	if (limit > 0) {
		snprintf(sys, sizeof(sys), "clang %s -o %s; ./%s", fileName, binaryName, binaryName);
		system(sys);
	}
	return 0;
}